(function(){"use strict";self.onmessage=n=>{const{type:r,payload:a}=n.data;try{switch(r){case"process_batch":b(a);break;case"calculate_metrics":M(a);break;case"generate_grid":_(a);break;default:throw new Error(`Unknown message type: ${r}`)}}catch(e){self.postMessage({type:"error",payload:{message:e instanceof Error?e.message:"Unknown error"}})}};function b(n){const{data:r,batchSize:a}=n,e=[...r];for(let c=e.length-1;c>0;c--){const l=Math.floor(Math.random()*(c+1));[e[c],e[l]]=[e[l],e[c]]}const o=a>0&&a<e.length?e.slice(0,a):e;self.postMessage({type:"batch_ready",payload:{batch:o}})}function M(n){const{predictions:r,labels:a,numClasses:e}=n,o=Array(e).fill(null).map(()=>Array(e).fill(0));for(let t=0;t<r.length;t++){const s=a[t]??0,i=r[t]??0;o[s]&&(o[s][i]=(o[s][i]??0)+1)}const c=[];for(let t=0;t<e;t++){let s=0,i=0,u=0;for(let d=0;d<e;d++)for(let y=0;y<e;y++){const m=o[d]?.[y]??0;d===t&&y===t?s+=m:y===t?i+=m:d===t&&(u+=m)}const h=s+i>0?s/(s+i):0,g=s+u>0?s/(s+u):0,k=h+g>0?2*h*g/(h+g):0;c.push({precision:h,recall:g,f1:k})}const l=c.reduce((t,s)=>t+s.precision,0)/e,f=c.reduce((t,s)=>t+s.recall,0)/e,p=c.reduce((t,s)=>t+s.f1,0)/e;self.postMessage({type:"metrics_ready",payload:{matrix:o,classMetrics:c,macro:{precision:l,recall:f,f1:p}}})}function _(n){const{gridSize:r,xRange:a,yRange:e}=n,o=[],c=(a[1]-a[0])/(r-1),l=(e[1]-e[0])/(r-1);for(let f=0;f<r;f++)for(let p=0;p<r;p++)o.push({x:a[0]+p*c,y:e[0]+f*l});self.postMessage({type:"grid_ready",payload:{grid:o}})}})();
//# sourceMappingURL=training.worker-BDP5YVMN.js.map
